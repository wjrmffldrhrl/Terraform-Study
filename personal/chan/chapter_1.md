# 1. 왜 테라폼인가?
## 1. 데브옵스의 등장
- 초기에는 운영과 개발이 분리되어 있어, 개발팀에서 코드를 짜고 운영팀은 하드웨어과 배포 등을 담당하였다.
- 문제는 소스코드라도 하드웨어, OS, 심지어는 라이브러리 버전에 따라서 작동이 안 되기도 하였다.
- 이런 문제를 해결하기 위해 운영에 관련한 내용들도 코드로 관리하기 시작하면서 데브옵스라는 개념이 생겨났다. (DevOps는 직무라기 보다는 프로세스)
## 2. 코드형 인프라란?
### 1. 에드혹 스크립트
- 배포와 관련된 작업들을 bash 같은 스크립트를 작성하는 방식
- 개발자들마다 각자의 스타일이 존재하여 확장성이나 기준을 잡기 힘듦
### 2. 구성 관리 도구
- 소프트웨어를 설치하고 구성하는 것을 관리하는 도구
- 스크립트에 비해 정해진 포맷이 있어 누가 작성해도 비슷한 구조
- 기본적으로 멱등성을 지원해 같은 걸 몇 번씩 실행해도 똑같은 작업이 실행됨 (ex. 서버가 실행되지 않았을 때만 실행된다)
- 분산형 구조를 가지고 있어 하나의 파일로 여러 서버를 동시에 관리 가능 (스크립트의 경우 각 스크립트를 각 서버에 실행을 시켜야함)
### 3. 서버 템플릿 도구
- 도커처럼 운영체제, 소프트웨어 등 필요한 내용을 모두 담고 있는 스냅샷 형태로 관리하는 도구
- 가상머신(vm)과 도커(container)가 대표적
### 4. 오케스트레이션 도구
- 서버 템플릿 도구가 vm이나 container를 생성하는 데는 편리하나 많아짐에 따라 관리하기는 힘든 면이 있어 생겨난 도구
- 쿠버네티스가 대표적
### 5. 프로비전 도구
- 위의 도구들이 서버에서 실행되는 코드들을 관리한다면 프로비전 도구는 서버 자체를 생성하는 도구
- 서버 뿐 아니라 DB, 네트워크, 방화벽, SSL 등까지 설정함
## 3. 코드형 인프라의 장점
- 배포 횟수가 증가하지만 오류 발생은 낮춤
- 코드로 관리되기 때문에 버전관리, 문서화, 재사용성에서 뛰어남
## 4. 테라폼의 작동 방식
- 여러 클라우드 서비스에서 제공하는 API를 직접 호출하는 방식으로 작동함
- 따라서 나중에 나오는 마스터 서버 등을 따로 구축하지 않아도 됨
## 5. 테라폼과 다른 코드형 인프라 도구 비교
### 1. 구성 관리 vs 프로비저닝
- 서로 어느정도 지원을 해서 명확하게 구분이 힘들 수도 있음
- 서버 템플릿에 구성 관리도 포함되어 있어, 서버 템플릿 + 프로비전 or 구성 관리 도구 + 프로비전의 방식을 추천
### 2. 가변 인프라 vs 불변 인프라
- 가변 인프라: 실행할 때, 기존 서버에서 업데이트가 진행되어 서버마다 결과가 다를 수가 있음
  - 업데이트가 되니 최신화에 도움이 되거나 변경 기록이 있으니 업데이트할 때는 도움이 될 듯?
- 불변 인프라: 항상 같은 상태로 실행되기 때문에 모든 서버가 똑같음
  - 사소한 수정이 있어도 매 번 재생성을 해야하는 단점이 존재
### 3. 절차적 언어 vs 선언적 언어
- 절차적 언어에서는 3개의 서버를 띄우라고 하면 실행할 때마다 3개씩 띄움
- 선언적 언어에서는 3개의 서버를 띄우라고 하면 실행할 때마다 3개만 유지하도록 띄움
- 선언적 언어에선 현재 서버 상태에 대한 것을 명확히 확인할 수 있음
### 4. 마스터 서버 유무
- 마스터 서버가 있으면 마스터 서버에서 관리해주는 게 있어 편리함이 있지만 반대로 마스터 서버를 위한 관리 포인트가 증가하는 단점이 존재
### 5. 에이전트 유무
- 에이전트가 있으면 각 서버에 에이전트를 설치해야 하는 불편함과 설치를 위한 관리나 보안 등에 문제가 있을 수 있음
- 테라폼은 각 클라우드의 에이전트에 직접 명령하는 방식
- 엔서블은 SSH를 사용하는 방식인데 매우 보편적이라 부담이 없음
### 6. 커뮤니티 규모와 활성화
- 앤서블과 테라폼이 크다
### 7. 성숙한 기술 vs 최첨단 기술
- 테라폼은 가장 최신의 기술이지만 그 만큼 사소한 버그가 존재할 가능성이 있음 (처음으로 단점을..)
- (개인적 의견) 기술의 성숙도보다는 해당 기술 사이트의 문서화가 중요하다고 느낌
### 8. 여러 도구를 함께 사용
- 위의 구성관리, 서버 템플릿, 오케스트레이션, 프로비전의 도구들을 잘 조합해서 사용하면 더 좋다.
## 6. 결론
- 저자가 필요한 요구 사항 중 테라폼이 가장 잘 맞아서 테라폼 선택했다.
