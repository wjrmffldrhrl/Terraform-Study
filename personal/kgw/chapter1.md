# 왜 테라폼인가?

기존에는 하드웨어를 관리하는 팀인 운영팀(Ops), 소프트웨어를 관리하는 개발팀(Devs)으로 역할이 명확히 분리되어 있었다.
운영팀은 개발팀에서 만든 어플리케이션을 수동으로 운영, 배포하였지만 조직이 커지면서 많은 문제가 생겼다.

하지만 클라우드의 등장으로 많은 중대한 변화들이 생겨났다. 시스템 관리자가 서버를 설치하고 네트워크 케이블 설치 작업을 하는 대신 코드를 작성하여 이러한 일들을 할 수 있게되었다. 이렇게 되며 이제는 개발팀과 운영팀 모두 소프트웨어 작업에 시간을 소비하게 되어 두 팀의 구분이 모호해졌고, 여기서 **데브옵스**가 태동하였다.

**데브옵스는 소프트웨어를 효율적으로 전달하는 프로세스다.**

데브옵스의 4가지 핵심
- 문화
- 자동화
- 측정
- 공유

코드형 인프라란 코드를 작성하여 인프라를 관리하는 것을 말한다. 이는 운영의 모든 측면을 소프트웨어적으로 생각하는 중대한 사고 전환을 보여준다.

코드형 인프라의 5가지 범주
- 애드혹 스크립트: 가장 간단한 형태로 작성한 스크립트를 서버에서 실행하는 형태. 소규모 일회성 작업에는 적합하지만 나중에는 관리하기 어려운 스파게티 코드로 전락할 가능성이 높다.

- 구성 관리 도구
  - 코딩 규칙: 일관되고 예측 가능한 구조
  - 멱등성: 실행 횟수와 관계없이 올바르게 동작하는 코드
  - 분산형 구조: 여러 대의 서버에서 일괄 업데이트

- 서버 템플릿 도구: 동일한 코드를 실행하여 서버를 구성하는 기존의 방식과 다르게, OS, 소프트웨어, 파일 등 서버 구성에 필요한 내용을 모두 담고 있는 스냅샷으로 이미지를 생성. 이는 한 번 배포된 서버는 다시 변경되지 않는 불변 인프라로 전환하는데 있어 핵심적인 구성 요소이다.

- 오케스트레이션 도구: 서버 템플릿 도구를 관리하기 위한 도구로 대포적으로 쿠버네티스가 있다. 도커 컨테이너를 관리하고 작동하기 위해 사용하는 서버들의 그룹을 배포한다.

- 프로비전 도구: 인프라에 관한 모든 부분을 프로비저닝

코드형 인프라의 장점
- 자급식 배포
- 속도와 안정성
- 문서화: 코드가 문서
- 버전 관리
- 유효성 검증
- 재사용성
- **행복**

테라폼은 클라우드 공급자가 제공하는 API 서버를 활용하여 인프라를 구성할 수 있다.

테라폼 비교
- 구성 관리 vs 프로비저닝: 구성 관리 도구와 프로비전 도구를 목적에 맞게 선택하여 사용하는 것이 바람직함.
- 가변 인프라 vs 불변 인프라: 완전히 새로운 서버를 배포함으로써 구성 드리프트 버그를 줄이고 이전 버전으로 손쉽게 복원할 수도 있다. 하지만 배포에 시간이 오래 걸리고 시간에 따른 하드 드라이브의 변경으로 완전한 구성 드리프트 해결은 아니다.
- 절차적 언어 vs 선언적 언어: 선언적 방식은 항상 인프라의 최신 상태를 나타내고 있으므로, 이전 버전의 상태에 대해 알 필요없이 그저 현재 원하는 상태만을 알고 있으면 된다.
- 마스터 서버 유무: 따로 마스터 서버가 필요없이 클라우드 업체가 제공하는 API를 이용하여 동작한다. 따라서 마스터 서버를 관리하기 위한 추가 인프라나 인증 메커니즘을 관리할 필요가 없다.
- 에이전트 유무: 개별적인 에이전트가 필요없이 클라우드 공급자의 에이전트가 모든 서버에서 명령을 실행한다.
- 커뮤니티 규모와 활성화: 테라폼과 앤서블은 활발한 커뮤니티 규모를 가지고 있으며 지금도 계속해서 커지고 있다.
- 성숙한 기술 vs 최첨단 기술: 다른 기술과 비교했을때 조금 미성숙한 기술이지만 이제는 많이 성숙함.
- 여러 도구를 함께 사용: 구성 관리 도구, 서버 템플릿, 오케스트레이션 도구 등 다양한 도구와 함께 사용할 수 있다.
